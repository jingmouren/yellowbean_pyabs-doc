建模
****

建模的过程是把ABS事实性的数据(比如债券信息，资产池，分配规则等)，进行实例化的过程。

目前 ``absbox`` 支持 ``信贷ABS`` 类。

.. _信贷ABS:

信贷ABS
====
.. code-block:: python

   from absbox.local.china import 信贷ABS


产品要素
====
日期
----

封包日/入池日:
  指 原始权益人 将 底层资产转移到SPV的当天。该日期之后所有资产的现金流的归属于SPV

起算日/起息日:
  指 产品 成立之后，负债端债券的起始计算利息的日期。

首次支付日:
  指 产品 成立之后，负债端第一次支付利息/本金的日期。

建模时按照顺序，通过建立一个tuple ``(封包日,起息日,首次支付日)`` 用于描述产品的日期要素.
因为日期有着业务顺序含义，因此无需通过字典形式进行建模，而是一个tuple即可。

.. code-block:: python

  ("2022-01-01","2022-03-01","2022-05-01")
  # 表示 封包日=2022-01-01,起息日=2022-03-01,首次支付日=2022-05-01

对于存量产品建模时候,我们基于的是受托报告，例如对应获取的日期信息是： 
  * 收款期间（2022-08-01,2022-09-01）
  * 债券当期兑付日 ： 2022-09-26

.. code-block:: python

  ("2022-09-01","2022-09-26","2022-10-26")
  # 表示 2022-09-01 之后的资产池现金流都会用于本次 2022-10-26日的债券兑付
  # 起息日=2022-09-26，表示 2022-10-26的债券兑付起息日为 2022-09-26
  # 下次支付日=2022-10-26

费用
----

费用类型包括
  * 一次性费用, 例如需要支付的承销费用。
  * 周期性费用, 例如一年一次的跟踪评级费用,或者每个月产生的事务性费用
  * 按照比例产生的费用
     * 例如按照 ``资产池余额`` ,或者 ``债券余额`` 作为基数的费用，计算年化费用
     * 或者按照 ``资产池利息`` ,作为基数的增值税计算费用
     * 或者按照 ``违约余额`` , 作为基数计算违约处置费用

建模格式为： ``(费用名称 , {费用描述} )``

示例为设定两个费用，一个按照当期资产池利息金额乘以3.25%。另外一个按照资产池余额的年化2%收取当期费用。

.. code-block:: python

  (("增值税",{"类型":{"百分比费率":["资产池当期利息",0.0325]}})
      ,("服务商费用",{"类型":{"年化费率":["资产池余额",0.02]}}))

资产池
----
用一个列表表示底层资产的清单，目前资产清单包含 ``按揭贷款`` ``消费贷款`` ``租金合同`` ``企业贷款`` .

按揭贷款

.. code-block:: python

  (["按揭贷款"
        ,{"放款金额":9961626400,"放款利率":"放款利率":["浮动",0.085,{"基准":"LPR5Y","利差":0.01,"重置频率":"每月"}],"初始期限":218
          ,"频率":"每月","类型":"等额本息","放款日":"2020-06-01"}
          ,{"当前余额":7596981800
          ,"当前利率":0.0495
          ,"剩余期限":165}]
      ,["按揭贷款"
        ,{"放款金额":330_977.45*10000,"放款利率":["固定",0.045],"初始期限":218
          ,"频率":"每月","类型":"等额本金","放款日":"2020-06-01"}
          ,{"当前余额":239_790.20*10000
          ,"当前利率":0.0495
          ,"剩余期限":165}])

账户
----
账户有两种：
  * 普通账户 -> 表示用于简单的现金收支。
  * 储备账户 -> 储备账户可以锚定一个储备金额数值。在存入金额和取出时，按照预定锚定的金额进行留存。

建模格式为 ``(账户名称,账户属性)``, 例如

.. code-block:: python

  (("本金分账户",{"余额":0})
   ,("收入分账户",{"余额":0}))

另外一种为 ``储备账户`` ，该类账户存在一个目标储备金额,其设置可以通过 ``账户属性`` 进行建模

目标储备金额: 有多种设置方式，例如

  * 单一值： 固定的绝对金额，例如，10000元
    ``("储备账户A",{"余额":0,"类型":{"固定储备金额":1000}})``
  * 公式值： 例如资产池余额的一个百分比，例如资产池余额的 2%
    ``("储备账户B",{"余额":0,"类型":{"目标储备金额":["资产池余额",0.015]}})``

  * 复合值： 例如为 单一值 公式值 两者取大，或者取小

    .. code-block:: python

      ("储备账户C",{"余额":0,"类型":{"较高":[
                                     {"目标储备金额":["资产池余额",0.015]}
                                    ,{"固定储备金额":100}]})
      ("储备账户D",{"余额":0,"类型":{"较低":[
                                     {"目标储备金额":["资产池余额",0.015]}
                                    ,{"固定储备金额":100}]})
      # 甚至可以进行多条件组合
      ("储备账户E",{"余额":0,"类型":{"较低":[{"较高":[
                                            {"目标储备金额":["资产池余额",0.015]}
                                            ,{"固定储备金额":100}]}
                                    ,{"固定储备金额":150}]})
债券
----

建模格式为 ``(债券层级名称,属性)`` ， 其中 ``利率类型`` 分为三种

  * 固定利率   :code:`"利率":{"固定":0.0569}`
  * 浮动利率   :code:`"利率":{"浮动":["LPR5Y",-0.0169,"每月"]}`
  * 期间收益   :code:`"利率":{"期间收益":0.02}`

债券种类众多，包括 ``过手摊还类`` ，``固定摊还`` ，``锁定类`` , ``权益类``：

  * 过手摊还类： 较为常见利随本清式债券。
  * 固定摊还： 预定义固定摊还目标额，限定了每次兑付时候最大的本金还款额。
  * 锁定类： 预定义一个日期，该日期之前都不会偿还本金
  * 权益：  权益类债券，用于次级证券建模, 可以支付超额收益。

.. code-block:: python

    ("A1",{"当前余额":3_650_000_000
                             ,"当前利率":0.03
                             ,"初始余额":3_650_000_000
                             ,"初始利率":0.03
                             ,"起息日":"2020-01-03"
                             ,"利率":{"浮动":["LPR5Y",-0.0169,"每月"]}
                             ,"债券类型":{"过手摊还":None}
                            })
      ,("A2",{"当前余额":5_444_000_000
                             ,"当前利率":0.03
                             ,"初始余额":5_444_000_000
                             ,"初始利率":0.03
                             ,"起息日":"2020-01-03"
                             ,"利率":{"浮动":["LPR5Y",-0.0091,"每月"]}
                             ,"债券类型":{"过手摊还":None}
                            })
      ,("次级",{"当前余额":900_883_783.62
                             ,"当前利率":0.0
                             ,"初始余额":2_123_875_534.53
                             ,"初始利率":0.00
                             ,"起息日":"2020-01-03"
                             ,"利率":{"期间收益":0.02}  # 期间收益必须满足 2%
                             ,"债券类型":{"权益":None}
                            })



分配规则
----

分配规则描述了一系列SPV资金的收取和支出的动作。包括

  * 支付费用

    * 格式为 ``["支付费用", [资金来源账户列表], [需要支付的费用列表]]``
    其中，
      *  ``[资金来源账户列表]``   -> 按照顺序，首先从第一个账户获取可用资金进行支付，以此类推
      *  ``[需要支付的费用列表]`` -> 按照列表中的费用，同顺序按照应付比例进行支付

  * 支付费用限额

    * 相比于 ``支付费用`` , 在最后新增一个map列表,用于描述支付费用的上限形式

      * ``应计费用百分比`` , 限制支付应计费用的比例上限
      * ``应计费用金额`` ,  限制支付应计费用的绝对金额
      示例 ``["支付费用限额",["收入分账户"],["服务商费用"],{"应计费用百分比":0.1}]``

  * 支付债券利息

    * 格式为 ``["支付利息", 资金来源账户, [需要支付的债券列表] ]``

  * 支付债券本金

    * 格式为 ``["支付本金", 资金来源账户, [需要支付的债券列表] ]``

  * 支付债券期间收益

    * 格式为 ``["支付期间收益", 资金来源账户, [需要支付的债券列表] ]``

  * 账户转移
   
    * 格式为 ``["支付费用", 资金来源账户, 目标转入账户 ]``
  
  * 出售资产
   
    * 格式为 ``["出售资产", 计价方式, 目标转入账户 ]``

建模方式为一个map, 支持的key为:

  * ``未违约``, 表示动作只有在 处于非违约状态的情况下，在债券支付日执行。
  * ``回款后``, 表示动作只有在 资产池搜集回款后执行。
  * ``清仓回购``, 表示动作只有在 清仓回购条件触发后执行。


示例：

.. code-block:: python

    ,{"未违约":[
         ["支付费用",["收入分账户"],["执行费用"]]
         ,["支付费用限额",["收入分账户"],["服务商费用"],{"应计费用百分比":0.1}]
         ,["支付利息","收入分账户",["A1","A2"]]
         ,["支付费用",["收入分账户"],["服务商费用"]]
         ,["支付期间收益","收入分账户",["次级"]]
         ,["账户转移","收入分账户","本金分账户"]
         ,["支付本金","本金分账户",["A1"]]
         ,["支付本金","本金分账户",["A2"]]
         ,["支付本金","本金分账户",["次级"]]
         ,["支付收益","本金分账户","次级"]]
     ,"回款后":[["支付费用",["收入分账户"],["增值税"]]]
     ,"清仓回购":[....]
     }



建模示例
====

简单优先/劣后结构
----

.. code-block:: python

    test01 = 信贷ABS(
        "TEST01"
        ,("2021-03-01","2021-10-15","2021-11-26")
        ,"每月"
        ,{'清单':[["按揭贷款"
            ,{"放款金额":120,"放款利率":["浮动",0.085,{"基准":"LPR5Y","利差":0.01,"重置频率":"每月"}],"初始期限":30
              ,"频率":"每月","类型":"等额本金","放款日":"2020-06-01"}
              ,{"当前余额":120
              ,"当前利率":0.08
              ,"剩余期限":10
              ,"状态":"正常"}]]
         }
        ,(("账户01",{"余额":0}),)
        ,(("A1",{"当前余额":100
                 ,"当前利率":0.07
                 ,"初始余额":100
                 ,"初始利率":0.07
                 ,"起息日":"2020-01-03"
                 ,"利率":{"固定":0.08}
                 ,"债券类型":{"过手摊还":None}
                 })
          ,("B",{"当前余额":20
                 ,"当前利率":0.0
                 ,"初始余额":100
                 ,"初始利率":0.07
                 ,"起息日":"2020-01-03"
                 ,"利率":{"固定":0.00}
                 ,"债券类型":{"权益":None}
                 }))
        ,tuple()
        ,{"未违约":[
             ["支付利息","账户01",["A1"]]
             ,["支付本金","账户01",["A1"]]
             ,["支付本金","账户01",["B"]]
             ,["支付收益","账户01","B"]
        ]
         ,"回款后":[]}
        ,(["利息回款","账户01"]
          ,["本金回款","账户01"]
          ,["早偿回款","账户01"]
          ,["回收回款","账户01"])
        ,None
    )

附带固定摊还的债券建模
----


.. code-block:: python

   test02 = 信贷ABS(
        "TEST02"
        ,("2021-03-01","2021-05-01","2021-06-26")
        ,"每月"
        ,{'清单':[["按揭贷款"
            ,{"放款金额":120,"放款利率":["固定",0.0485],"初始期限":30
              ,"频率":"每月","类型":"等额本金","放款日":"2020-06-01"}
              ,{"当前余额":120
              ,"当前利率":0.08
              ,"剩余期限":10
              ,"状态":"正常"}]],
         }
        ,(("账户01",{"余额":0}),)
        ,(("A1",{"当前余额":100
                 ,"当前利率":0.07
                 ,"初始余额":100
                 ,"初始利率":0.07
                 ,"起息日":"2020-01-03"
                 ,"利率":{"固定":0.08}
                 ,"债券类型":{"固定摊还":[["2021-06-26",80]
                                        ,["2021-07-26",70]
                                        ,["2021-09-26",0]]}
                 })
          ,("B",{"当前余额":20
                 ,"当前利率":0.0
                 ,"初始余额":100
                 ,"初始利率":0.07
                 ,"起息日":"2020-01-03"
                 ,"利率":{"固定":0.00}
                 ,"债券类型":{"权益":None}
                 }))
        ,tuple()
        ,{"未违约":[
             ["支付利息","账户01",["A1"]]
             ,["支付本金","账户01",["A1"]]
             ,["支付本金","账户01",["B"]]
             ,["支付收益","账户01","B"]
        ]
         ,"回款后":[]}
        ,(["利息回款","账户01"]
          ,["本金回款","账户01"]
          ,["早偿回款","账户01"]
          ,["回收回款","账户01"])
        ,None
    )


案例3

次级分润模式 





某建元
----

.. code-block:: python

    JY_RMBS_01 = 信贷ABS(
        "建元"
        ,("2022-10-02","2022-10-02","2022-11-02")
        ,"每月"
        ,{"清单":[["按揭贷款"
              ,{"放款金额":18_000_000_000,"放款利率":["固定",0.0485],"初始期限":180
              ,"频率":"每月","类型":"等额本息","放款日":"2020-06-01"}
              ,{"当前余额":17_000_000_000
              ,"当前利率":0.04
              ,"剩余期限":180
              ,"状态":"正常"}]]
         }
        ,(("本金分账户",{"余额":0})
          ,("储备账户",{"余额":0})
          ,("收入分账户",{"余额":0})
          ,("信托税收",{"余额":0}))
        ,(("A1",{"当前余额":3_000_000_000
                                 ,"当前利率":0.03
                                 ,"初始余额":3_000_000_000
                                 ,"初始利率":0.03
                                 ,"起息日":"2020-01-03"
                                 ,"利率":{"浮动":["LPR5Y",0.01,{"重置月份":3}]}
                                 ,"债券类型":{"过手摊还":None}
                                })
          ,("A2",{"当前余额":5_000_000_000
                                 ,"当前利率":0.03
                                 ,"初始余额":5_000_000_000
                                 ,"初始利率":0.03
                                 ,"起息日":"2020-01-03"
                                 ,"利率":{"浮动":["LPR5Y",0.01,{"重置月份":3}]}
                                 ,"债券类型":{"过手摊还":None}
                                })
          ,("A3",{"当前余额":6_999_000_000
                                 ,"当前利率":0.03
                                 ,"初始余额":5_000_000_000
                                 ,"初始利率":0.03
                                 ,"起息日":"2020-01-03"
                                 ,"利率":{"浮动":["LIBOR1M",0.01,{"重置月份":3}]}
                                 ,"债券类型":{"过手摊还":None}
                                })
          ,("次级",{"当前余额":2_123_875_534.53
                                 ,"当前利率":0.03
                                 ,"初始余额":2_123_875_534.53
                                 ,"初始利率":0.03
                                 ,"起息日":"2020-01-03"
                                 ,"利率":{"固定":0.0}
                                 ,"债券类型":{"过手摊还":None}
                                }))
        ,(("增值税",{"类型":{"百分比费率":["资产池当期利息",0.0325]}})
          ,("服务商费用",{"类型":{"年化费率":["资产池余额",0.02]}}))
        ,{"未违约":[
             ["支付费用限额",["收入分账户"],["服务商费用"],{"应计费用百分比":0.5}]
             ,["支付利息","收入分账户",["A1","A2","A3"]]
             ,["支付费用",["收入分账户"],["服务商费用"]]
             ,["账户转移","收入分账户","本金分账户"]
             ,["支付本金","本金分账户",["A1"]]
             ,["支付本金","本金分账户",["A2"]]
             ,["支付本金","本金分账户",["A3"]]
             ,["支付本金","本金分账户",["次级"]]
             ,["支付收益","本金分账户","次级"]],
         "回款后":[["支付费用",["收入分账户"],["增值税"]]]
         }
        ,(["利息回款","收入分账户"]
          ,["本金回款","本金分账户"]
          ,["早偿回款","本金分账户"]
          ,["回收回款","本金分账户"])
        ,None
    )

某工元
----

.. code-block:: python

    gy = 信贷ABS(
        "工元乐居2021年第七期"
        ,("2021-03-01","2021-10-15","2021-11-26")
        ,"每月"
        ,{"清单":[["按揭贷款"
            ,{"放款金额":9961626400,"放款利率":["固定",0.0485],"初始期限":218
              ,"频率":"每月","类型":"等额本息","放款日":"2020-06-01"}
              ,{"当前余额":7596981800
              ,"当前利率":0.0495
              ,"剩余期限":165
              ,"状态":"正常"}]
          ,["按揭贷款"
            ,{"放款金额":330_977.45*10000,"放款利率":["固定",0.0485],"初始期限":218
              ,"频率":"每月","类型":"等额本金","放款日":"2020-06-01"}
              ,{"当前余额":239_790.20*10000
              ,"当前利率":0.0495
              ,"剩余期限":165
              ,"状态":"正常"}]]
         }
        ,(("本金分账户",{"余额":0})
          ,("收入分账户",{"余额":0}))
        ,(("A1",{"当前余额":3_650_000_000
                                 ,"当前利率":0.03
                                 ,"初始余额":3_650_000_000
                                 ,"初始利率":0.03
                                 ,"起息日":"2020-01-03"
                                 ,"利率":{"浮动":["LPR5Y",-0.0169,{"重置月份":3}]}
                                 ,"债券类型":{"过手摊还":None}
                                })
          ,("A2",{"当前余额":5_444_000_000
                                 ,"当前利率":0.03
                                 ,"初始余额":5_444_000_000
                                 ,"初始利率":0.03
                                 ,"起息日":"2020-01-03"
                                 ,"利率":{"浮动":["LPR5Y",-0.0091,{"重置期间":"每年","起始":"2022-11-01"}]}
                                 ,"债券类型":{"过手摊还":None}
                                })
          ,("次级",{"当前余额":900_883_783.62
                                 ,"当前利率":0.0
                                 ,"初始余额":2_123_875_534.53
                                 ,"初始利率":0.00
                                 ,"起息日":"2020-01-03"
                                 ,"利率":{"期间收益":0.02}
                                 ,"债券类型":{"权益":None}
                                }))
        ,(("增值税",{"类型":{"百分比费率":["资产池当期利息",0.0325]}})
          ,("服务商费用",{"类型":{"年化费率":["资产池余额",0.02]}})
          ,("执行费用", {"类型":{"周期费用":["每月",599]}}))
        ,{"未违约":[
             ["支付费用",["收入分账户"],["执行费用"]]
             ,["支付费用限额",["收入分账户"],["服务商费用"],{"应计费用百分比":0.1}]
             ,["支付利息","收入分账户",["A1","A2"]]
             ,["支付费用",["收入分账户"],["服务商费用"]]
             ,["支付期间收益","收入分账户",["次级"]]
             ,["账户转移","收入分账户","本金分账户"]
             ,["支付本金","本金分账户",["A1"]]
             ,["支付本金","本金分账户",["A2"]]
             ,["支付本金","本金分账户",["次级"]]
             ,["支付收益","本金分账户","次级"]]
         ,"回款后":[["支付费用",["收入分账户"],["增值税"]]]}
        ,(["利息回款","收入分账户"]
          ,["本金回款","本金分账户"]
          ,["早偿回款","本金分账户"]
          ,["回收回款","本金分账户"])
        ,None
    )



某存量建元(带清仓回购) 
---- 

.. code-block:: python

    JY_RMBS_2017_5 = 信贷ABS(
        "建元2017年第五期个人住房抵押贷款资产支持证券"
        ,("2022-07-26","2022-07-26","2022-08-26")
        ,"每月"
        ,{'清单':[["按揭贷款"
            ,{"放款金额":120,"放款利率":["浮动",0.085,{"基准":"LPR5Y","利差":0.01,"重置频率":"每月"}],"初始期限":30
              ,"频率":"每月","类型":"等额本金","放款日":"2020-06-01"}
              ,{"当前余额":2_261_042_196.13
              ,"当前利率":0.0444
              ,"剩余期限":106
              ,"状态":"正常"}]
          ,["按揭贷款"
            ,{"放款金额":0,"放款利率":["浮动",0.085,{"基准":"LPR5Y","利差":0.01,"重置频率":"每月"}],"初始期限":30
              ,"频率":"每月","类型":"等额本金","放款日":"2020-06-01"}
              ,{"当前余额": 81_403_764.08
              ,"当前利率":0.0444
              ,"剩余期限":106
              ,"状态":"违约"}]]
         }
        ,(("本金分账户",{"余额":0 })
          ,("收入分账户",{"余额":0,"记录":[("2019-12-01",0,-81_403_764.08,"To:本金分账户|ABCD")]})
          )
        ,(("A1",{"当前余额":0.00
                 ,"当前利率":0.051
                 ,"初始余额":2_903_000_000.00
                 ,"初始利率":0.051
                 ,"起息日":"2020-01-03"
                 ,"利率":{"浮动":["LPR5Y",0.012,{"重置月份":3}]}
                 ,"债券类型":{"过手摊还":None}
                 })
           ,("A2",{"当前余额":0.00
                 ,"当前利率":0.051
                 ,"初始余额":2_903_000_000.00
                 ,"初始利率":0.051
                 ,"起息日":"2020-01-03"
                 ,"利率":{"浮动":["LPR5Y",0.012,{"重置月份":3}]}
                 ,"债券类型":{"过手摊还":None}
                 })
           ,("A3",{"当前余额":1_456_725_400.00
                 ,"当前利率":0.051
                 ,"初始余额":2_903_000_000.00
                 ,"初始利率":0.051
                 ,"起息日":"2020-01-03"
                 ,"利率":{"浮动":["LPR5Y",0.002,{"重置月份":3}]}
                 ,"债券类型":{"过手摊还":None}
                 })
          ,("次级",{"当前余额":795_626_718.16
                 ,"当前利率":0.0
                 ,"初始余额":795_626_718.16
                 ,"初始利率":0.0
                 ,"起息日":"2020-01-03"
                 ,"利率":{"固定":0.00}
                 ,"债券类型":{"权益":None}
                 }))
        ,(("增值税",{"类型":{"百分比费率":["资产池当期利息",0.0326]}})
          ,("服务商费用",{"类型":{"年化费率":["资产池余额",0.0012]}})
          ,("报销",{"类型":{"周期费用":["每月",60000]}})
         )
        ,{"未违约":[
            ["支付费用限额",["收入分账户"],["服务商费用"],{"应计费用百分比":0.5}]
             ,["支付费用限额",["收入分账户"],["报销"],{"应计费用上限":50000}]
             ,["支付利息","收入分账户",["A1","A2","A3"]]
             ,["支付费用",["收入分账户"],["服务商费用"]]
             ,["按公式账户转移","收入分账户","本金分账户","A+B+C-D"]
             ,["支付费用",["收入分账户"],["报销"]]
             ,["账户转移","收入分账户","本金分账户"]
             ,["支付本金","本金分账户",["A1"]]
             ,["支付本金","本金分账户",["A2"]]
             ,["支付本金","本金分账户",["A3"]]
             ,["支付本金","本金分账户",["次级"]]
             ,["支付收益","本金分账户","次级"]
          ]
         ,"回款后":[["支付费用",["收入分账户"],["增值税"]]]
         ,"清仓回购":[["出售资产",["正常|违约",1.0,0.0],"收入分账户"]]}
        ,(["利息回款","收入分账户"]
          ,["本金回款","本金分账户"]
          ,["早偿回款","本金分账户"]
          ,["回收回款","本金分账户"])
        ,None
       )

盛世融迪2021年第二期个人汽车抵押贷款
----
依据第十期受托报告建立，
  * 假设次级的获取所有剩余收益
  * 假设不产生各项报销费用
  * 假设服务商费用年化 0.12%
  * 清仓回购对于正常资产按照 余额进行出售。

本案例假设使用现金流归集表进行建模。

.. code-block:: python

    BYD_AUTO_2021_2 = 信贷ABS(
        "盛世融迪2021年第二期个人汽车抵押贷款"
        ,("2022-07-30","2022-07-26","2022-08-26")
        ,"每月"
        ,{'发行':{'资产池规模':2_353_348_391.45},
          '归集表':[
             ["2022-07-01",1234640402,78501963.04,954043.04]
            ,["2022-08-01",1157265240,77375162.14,891648.43]
            ,["2022-09-01",1080039426,77225814.18,852731.81]
            ,["2022-10-01",1003282127,76757298.83,813484.98]
            ,["2022-11-01",927427822.3,75854304.71,774101.65]
            ,["2022-12-01",852342434.9,75085387.41,734796.34]
            ,["2023-01-01",780421405.7,71921029.21,695343.12]
            ,["2023-02-01",712379940.6,68041465.05,655964.23]
            ,["2023-03-01",646490512.9,65889427.7,616857.95]
            ,["2023-04-01",584776933.2,61713579.7,577837.7]
            ,["2023-05-01",527867450.6,56909482.63,539331.19]
            ,["2023-06-01",470936840,56930610.58,503085.91]
            ,["2023-07-01",414031471.4,56905368.58,466755.77]
            ,["2023-08-01",357238793.3,56792678.1,430516.11]
            ,["2023-09-01",300569969.4,56668823.93,394715.61]
            ,["2023-10-01",244168401.8,56401567.55,359341.72]
            ,["2023-11-01",188261231.6,55907170.23,324663.69]
            ,["2023-12-01",135214312.8,53046918.78,290675.76]
            ,["2024-01-01",95533450.08,39680862.74,257752.51]
            ,["2024-02-01",68181138.8,27352311.28,226897.8]
            ,["2024-03-01",47481932.22,20699206.58,198247.82]
            ,["2024-04-01",36412499.53,11069432.69,170618.51]
            ,["2024-05-01",31649692,4762807.53,145060.5]
            ,["2024-06-01",26867972.61,4781719.39,126148.64]
            ,["2024-07-01",22080740.39,4787232.22,107159.95]
            ,["2024-08-01",17274503.87,4806236.52,88155.65]
            ,["2024-09-01",12570553.22,4703950.65,69099.78]
            ,["2024-10-01",8474147.69,4096405.53,50432.44]
            ,["2024-11-01",5267663.01,3206484.68,34157.1]
            ,["2024-12-01",3048007.94,2219655.07,21390.56]
            ,["2025-01-01",1782441.89,1265566.05,12491.46]
            ,["2025-02-01",972018.42,810423.47,7372.76]
            ,["2025-03-01",353663.75,618354.67,4075.94]
            ,["2025-04-01",0,353663.75,1537.85]
          ]
         }
        ,(("本金分账户",{"余额":0 })
          ,("收入分账户",{"余额":0,"记录":[("2019-12-01",0,-1_638_256.13,"To:本金分账户|ABCD")]})
          ,("流动性储备",{"余额":15_757_708.38
                        ,"类型":{"较高":[{"目标储备金额":["资产池余额",0.012]}
                                       ,{"目标储备金额":["资产池初始余额",0.005]}]}})
          ,("收款账户",{"余额":0 })
         )
        ,(("优先",{"当前余额":716_739_000.00
                 ,"当前利率":0.026
                 ,"初始余额":1_730_000_000.00
                 ,"初始利率":0.026
                 ,"起息日":"2022-07-26"
                 ,"利率":{"固定":0.026}
                 ,"债券类型":{"过手摊还":None}
                 })
          ,("次级",{"当前余额":270_000_000.00
                 ,"当前利率":0.0
                 ,"初始余额":270_000_000.00
                 ,"初始利率":0.0
                 ,"起息日":"2022-07-26"
                 ,"利率":{"固定":0.00}
                 ,"债券类型":{"权益":None}
                 }))
        ,(("增值税",{"类型":{"百分比费率":["资产池当期利息",0.0326]}})
          ,("服务商费用",{"类型":{"年化费率":["资产池余额",0.0012]}})
         )
        ,{"未违约":[
             ["账户转移","流动性储备","收入分账户"]
             ,["支付费用",["收入分账户"],["服务商费用"]]
             ,["支付利息","收入分账户",["优先"]]
             ,["储备账户转移","收入分账户","流动性储备","目标储备"]
             ,["按公式账户转移","收入分账户","本金分账户","A+B+C-D"]
             ,["账户转移","收入分账户","本金分账户"]
             ,["支付本金","本金分账户",["优先"]]
             ,["支付本金","本金分账户",["次级"]]
             ,["支付收益","本金分账户","次级"]
          ]
         ,"回款后":[["支付费用",["收入分账户"],["增值税"]]]
         ,"清仓回购":[
                     ["出售资产",["正常|违约",1.0,0.0],"本金分账户"]
                     ,["账户转移","收入分账户","收款账户"]
                     ,["账户转移","本金分账户","收款账户"]
                     ,["账户转移","流动性储备","收款账户"]
                     ,["支付费用",["收款账户"],["服务商费用"]]
                    ,["支付利息","收款账户",["优先"]]
                    ,["支付本金","收款账户",["优先"]]
                    ,["支付本金","收款账户",["次级"]]
                    ,["支付收益","收款账户","次级"]
                 ]
         }
        ,(["利息回款","收入分账户"]
          ,["本金回款","本金分账户"]
          ,["早偿回款","本金分账户"]
          ,["回收回款","本金分账户"])
        ,None
    )


建模文件保存/读取
====
建议通过python自带的 ``pickle`` 包对建模文件进行存储。

保存
----
建模的内容可以通过调用 ``save()`` 方法将内容保存至本地文件夹。

.. code-block:: python

  ...
  from absbox import API,save
  deal = .... #
  save(deal,"path/to/file")

读取
----
建模的内容可以通过调用 ``load()`` 方法将内容保存至本地文件夹。

.. code-block:: python

  ...
  from absbox.local.china import 信贷ABS
  信贷ABS.load("path/to/file")
